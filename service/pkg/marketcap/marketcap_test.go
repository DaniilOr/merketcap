package marketcap

import "testing"

func TestWma(t *testing.T) {
	type args struct {
		ps []float64
	}
	tests := []struct {
		name string
		args args
		want float64
	}{
		{name: "1to10", args: args{ps: []float64{1, 1, 1, 1, 1, 1, 1, 1, 1, 1}}, want: 1.0},
		{name: "1to5", args: args{ps: []float64{1,2,3,4,5}}, want:  3.6666666666666665},
		{name: "5to1", args: args{ps: []float64{1.2504230050988014e+08, 1.3846238498343554e+08, 1.135591001114553e+08,
			1.089645127329915e+08, 1.118502318124129e+08, 1.0616412828506663e+08, 9.938970075203551e+07, 9.26818399235942e+07, 9.450877428934686e+07, 9.187924307024992e+07, 1.077157674478595e+08,
			1.1149409350323354e+08, 1.056607362364764e+08, 1.0939879702755682e+08, 1.250753314589556e+08, 1.247661624940726e+08, 1.1753645895851655e+08, 1.1801929154601537e+08, 1.076192897463477e+08, 1.2017923292697193e+08,
			1.1851250150105964e+08, 1.2583990295852388e+08, 1.2242163062819624e+08, 1.211095997116887e+08, 1.0724246352045292e+08, 1.1726354406740808e+08, 9.898236537903468e+07, 1.0236925944351956e+08,
			9.838481627258708e+07, 9.63911275204779e+07, 9.721224135937978e+07, 9.244450569982208e+07, 7.715511313578439e+07, 6.834779561099431e+07, 6.920706569573756e+07}}, want:  1.0271382199483842e+08},
		{name: "arbitrary", args: args{ps: []float64{290918491377.4263, 280884355081.8832, 270861474696.8788, 258444691650.45676, 250277144256.90967, 269259968844.17865, 273282959377.16385, 277797467178.9324, 273212191168.80087,
			255676477656.11505, 267780847560.7458, 293069092285.9822, 307950352777.1147, 317645696234.40533, 318896956050.49414, 320822874720.786, 340840444354.05853, 341593133885.9346, 397069786479.458, 376577399573.75275, 407777080465.99713, 404131394792.0565,
			403465702897.4137, 451905650093.7062, 454991994900.06, 457761219806.8634, 482881900490.92126, 438585075673.5372, 430445282301.2706, 472663570788.4177, 421619090682.81805, 415801534961.892, 380482843865.20184, 391850295263.04333, 285298709244.80914, 322857390498.8056, 281879243639.0524, 266263966983.5743, 244704904961.2523, 309821867143.2342, 314033309034.22, 335196485645.8644}},
			want:  357367791643.8322},
	}

	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			if got := wma(tt.args.ps); got != tt.want {
				t.Errorf("Wma() = %v, want %v", got, tt.want)
			}
		})
	}
}
